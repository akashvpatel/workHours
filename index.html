<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Work Hours Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; padding: 10px; }
    h2, h3, h4 { text-align: center; }
    form, #summary { max-width: 500px; margin: auto; }
    label { display: block; margin-top: 10px; }
    input, select, button { width: 100%; padding: 8px; margin-top: 5px; }
    #summary p { background: #f4f4f4; padding: 8px; border-radius: 5px; margin: 5px 0; }
    button { cursor: pointer; border: none; border-radius: 5px; }
    button:hover { opacity: 0.9; }
    .danger { background: #d9534f; color: white; }
    .success { background: #5cb85c; color: white; }
    .copy-btn { background: #0275d8; color: white; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>Work Hours Tracker</h2>

  <form id="workForm">
    <label>Week Start Date (Monday):
      <input type="date" id="weekStart">
    </label>
    <label>Week End Date (Sunday):
      <input type="date" id="weekEnd">
    </label>
    <button type="button" class="success" onclick="saveWeek()">Save Week</button>

    <label>Date:
      <input type="date" id="date" required>
    </label>
    <label>Start Time:
      <input type="time" id="startTime" value="07:00" required>
    </label>
    <label>End Time:
      <input type="time" id="endTime" value="15:00" required>
    </label>
    <label>Shift:
      <select id="shift">
        <option>Morning</option>
        <option>Afternoon</option>
        <option>Night</option>
      </select>
    </label>
    <label>Location:
      <select id="location">
        <option>Bakery</option>
        <option>Warehouse</option>
      </select>
    </label>
    <button type="submit" class="success">Add Entry</button>
    <button type="button" class="danger" onclick="clearAll()">Clear All Entries</button>
    <button type="button" class="copy-btn" onclick="copySummary()">Copy Summary</button>
  </form>

  <div id="summary"><h3>No entries yet</h3></div>

  <script>
    let entries = JSON.parse(localStorage.getItem("workEntries")) || [];

    function formatDate(date) {
      return date.toLocaleDateString("en-GB", {
        day: "2-digit",
        month: "short",
        year: "numeric"
      });
    }

    function formatTime(time) {
      const [h, m] = time.split(":");
      let hour = parseInt(h), suffix = "AM";
      if (hour >= 12) { suffix = "PM"; if (hour > 12) hour -= 12; }
      if (hour === 0) hour = 12;
      return `${hour}:${m} ${suffix}`;
    }

    function getDayName(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString("en-US", { weekday: "long" });
    }

    function saveWeek() {
      const start = document.getElementById("weekStart").value;
      const end = document.getElementById("weekEnd").value;
      if (start && end) {
        localStorage.setItem("savedWeekStart", start);
        localStorage.setItem("savedWeekEnd", end);
        alert("Week saved: " + start + " to " + end);
        renderSummary();
      } else {
        alert("Please select both start and end dates.");
      }
    }

    function renderSummary() {
      const summary = document.getElementById("summary");
      const savedStart = localStorage.getItem("savedWeekStart");
      const savedEnd = localStorage.getItem("savedWeekEnd");

      if (savedStart && savedEnd) {
        const weekStart = formatDate(new Date(savedStart));
        const weekEnd = formatDate(new Date(savedEnd));
        summary.innerHTML = `<h3>Week: ${weekStart} - ${weekEnd}</h3>`;
      } else {
        summary.innerHTML = `<h3>No week selected</h3>`;
      }

      entries.sort((a, b) => new Date(a.date) - new Date(b.date));
      let totalHours = 0;

      entries.forEach((entry, index) => {
        const start = new Date(`1970-01-01T${entry.start}`);
        const end = new Date(`1970-01-01T${entry.end}`);
        let hours = (end - start) / (1000 * 60 * 60);
        if (hours < 0) hours += 24;
        totalHours += hours;

        const formattedDate = formatDate(new Date(entry.date));
        const dayName = getDayName(entry.date);

        summary.innerHTML += `
          <p>
            ${dayName} (${formattedDate}) : ${hours} hours 
            (${formatTime(entry.start)} - ${formatTime(entry.end)}), 
            ${entry.shift} shift, ${entry.location}
            <button onclick="removeEntry(${index})">‚ùå</button>
          </p>`;
      });

      if (entries.length > 0) {
        summary.innerHTML += `<h4>Total working hours: ${totalHours}</h4>`;
      }
    }

    document.getElementById("workForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const entry = {
        date: document.getElementById("date").value,
        start: document.getElementById("startTime").value,
        end: document.getElementById("endTime").value,
        shift: document.getElementById("shift").value,
        location: document.getElementById("location").value
      };
      entries.push(entry);
      localStorage.setItem("workEntries", JSON.stringify(entries));
      renderSummary();
      e.target.reset();
      document.getElementById("startTime").value = "07:00";
      document.getElementById("endTime").value = "15:00";
    });

    function removeEntry(index) {
      entries.splice(index, 1);
      localStorage.setItem("workEntries", JSON.stringify(entries));
      renderSummary();
    }

    function clearAll() {
      if (confirm("Are you sure you want to delete all saved entries and reset the week?")) {
        entries = [];
        localStorage.removeItem("workEntries");
        localStorage.removeItem("savedWeekStart");
        localStorage.removeItem("savedWeekEnd");
        renderSummary();
      }
    }

    function copySummary() {
      const text = document.getElementById("summary").innerText;
      navigator.clipboard.writeText(text).then(() => {
        alert("Summary copied to clipboard!");
      });
    }

    window.onload = function() {
      const savedStart = localStorage.getItem("savedWeekStart");
      const savedEnd = localStorage.getItem("savedWeekEnd");
      if (savedStart && savedEnd) {
        document.getElementById("weekStart").value = savedStart;
        document.getElementById("weekEnd").value = savedEnd;
      }
      renderSummary();
    };
  </script>
</body>
</html>
